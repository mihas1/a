(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,n){e.exports=n(50)},27:function(e,t,n){},33:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),i=n.n(c),o=(n(27),n(10)),s=n(9),l=n(7),u={page:{tickets:[]},filters:{available:{},active:{}},currency:{available:["RUB","USD","EUR"],active:"RUB",symbol:"",rate:1}},m="SET_CURRENCY",p="SET_CURRENCY_RATE",f="SET_CURRENCY_SYMBOL",d="SET_TICKETS",y="SET_FILTER_AVAILABLE",v="SET_FILTER_ACTIVE";var h=Object(s.b)({currency:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.currency,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(l.a)({},e,{active:t.payload});case p:return Object(l.a)({},e,{rate:t.payload});case f:return Object(l.a)({},e,{symbol:t.payload});default:return e}},filters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.filters,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(l.a)({},e,{available:t.payload});case v:return Object(l.a)({},e,{active:t.payload});default:return e}},page:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.page,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return Object(l.a)({},e,{tickets:t.payload});default:return e}}}),b=Object(s.c)(h),g=n(1),E=n(2),j=n(5),k=n(3),O=n(4),C=(n(32),n(33),n(35),n(37),n(16),n(39),function(e){function t(){return Object(g.a)(this,t),Object(j.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.getCurrSymbol(this.props.currency.active)}},{key:"getCurrSymbol",value:function(e){var t=this;window.fetch("https://restcountries.eu/rest/v2/currency/"+e).then(function(e){return e.json()}).then(function(e){t.props.setCurrencySymbol(e[0].currencies[0].symbol)}).catch(function(e){console.error(e)})}},{key:"getCurrRate",value:function(e){var t=this;"RUB"===e?this.props.setCurrencyRate(1):window.fetch("https://free.currencyconverterapi.com/api/v5/convert?q=RUB_"+e+"&compact=y").then(function(e){return e.json()}).then(function(n){t.props.setCurrencyRate(n["RUB_"+e].val)}).catch(function(e){console.error(e)})}},{key:"changeCurrency",value:function(e){this.getCurrSymbol(e),this.getCurrRate(e),this.props.setCurrency(e)}},{key:"render",value:function(){var e=this,t=this.props.currency,n=t.active,a=t.available.map(function(t,a){return r.a.createElement("div",{className:"currency-btn "+(n===t?"active":""),onClick:function(){return e.changeCurrency(t)},key:a+"_"+t},t)});return r.a.createElement("div",{className:"currency"},r.a.createElement("div",{className:"sidebar-title currency-title"},"\u0412\u0430\u043b\u044e\u0442\u0430"),r.a.createElement("div",{className:"currency-container"},a))}}]),t}(a.Component)),N=n(11),_=n(8),w=function(e){return r.a.createElement("span",{className:"stops-only",onClick:function(){return e.only(e.filter)}},"\u0422\u043e\u043b\u044c\u043a\u043e")},A={img:function(e,t){var n={TK:{img:"/tk.png",alt:"turkish airlines"},S7:{img:"/s7.png",alt:"s7"},BA:{img:"/ba.png",alt:"british airways"},SU:{img:"/su.png",alt:"aeroflot"}};return e in n&&t in n[e]?n[e][t]:""},formatStops:function(e){var t="",n=e;if(isNaN(parseFloat(n))||(n=parseFloat(n)),1===n)t=" \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430";else if(n>1&&n<5)t=" \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438";else if(n>=5)t=" \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a";else{if(0===n)return"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a";if("all"===n)return"\u0412\u0441\u0435"}return n+t},monthByNum:function(e){return["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"][e]},dayByNum:function(e){return["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"][e]},formatDate:function(e,t){var n=new Date(e.replace(/\./g,"/")),a=n.getDay(),r=n.getDate(),c=n.getMonth(),i=n.getFullYear();return"month"===t?r+" "+this.monthByNum(c)+" "+i:"day"===t?this.dayByNum(a):e},formatPrice:function(e){var t=e,n=3,a="";if(t.length>3){for(var r=t.length;0!==r;r--)0===n?(a=t[r-1]+" "+a,n=3):(a=t[r-1]+""+a,n--);return a}return e}},R=(n(41),function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(j.a)(this,Object(k.a)(t).call(this,e))).onChange=n.onChange.bind(Object(_.a)(Object(_.a)(n))),n.only=n.only.bind(Object(_.a)(Object(_.a)(n))),n}return Object(O.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.onChange()}},{key:"onChange",value:function(e){var t=this.props,n=t.filters,a=t.setFilterActive,r=n.active,c=Object.assign({},r);void 0!==e?e in c?(delete c[e],delete c.all):(c[e]=null,"all"!==e&&delete c.all):c.all=null,a(c)}},{key:"only",value:function(e){this.props.setFilterActive(Object(N.a)({},e,null))}},{key:"render",value:function(){var e=this,t=this.props,n=t.currency,a=t.filters,c=n.symbol,i=n.rate,o=a.available,s=a.active,l=Object.keys(o).map(function(t,n){return r.a.createElement("div",{className:"stops-item",key:n+"_"+t},r.a.createElement("input",{id:t,type:"checkbox",checked:t in s,onChange:function(){return e.onChange(t)}}),r.a.createElement("label",{className:"stops-label",htmlFor:t},A.formatStops(t),r.a.createElement("span",{className:"stops-from"},"\u043e\u0442 ",A.formatPrice((o[t]*i).toFixed()),c)),"all"!==t&&r.a.createElement(w,{only:e.only,filter:t}))});return r.a.createElement("div",{className:"stops"},r.a.createElement("div",{className:"sidebar-title stops-title"},"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"),r.a.createElement("div",{className:"stops-container"},r.a.createElement("div",{className:"stops-item"},r.a.createElement("input",{id:"all",type:"checkbox",checked:"all"in s,onChange:function(){return e.onChange("all")}}),r.a.createElement("label",{className:"stops-label",htmlFor:"all"},A.formatStops("all"))),l))}}]),t}(a.Component)),S=function(e){function t(){return Object(g.a)(this,t),Object(j.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currency,n=e.filters,a=e.setCurrencyAction,c=e.setCurrencyRateAction,i=e.setCurrencySymbolAction,o=e.setFilterActiveAction;return r.a.createElement("div",{className:"sidebar"},r.a.createElement(C,{currency:t,setCurrency:a,setCurrencyRate:c,setCurrencySymbol:i}),r.a.createElement(R,{currency:t,filters:n,setFilterActive:o}))}}]),t}(a.Component),T=Object(o.b)(function(e){return{currency:e.currency,filters:e.filters}},function(e){return{setCurrencyAction:function(t){return e(function(e){return{type:m,payload:e}}(t))},setCurrencyRateAction:function(t){return e(function(e){return{type:p,payload:e}}(t))},setCurrencySymbolAction:function(t){return e(function(e){return{type:f,payload:e}}(t))},setFilterActiveAction:function(t){return e(function(e){return{type:v,payload:e}}(t))}}})(S),F=(n(43),n(45),function(e){function t(){return Object(g.a)(this,t),Object(j.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.symbol,a=e.rate,c=t.carrier,i=void 0===c?"carrier":c,o=t.price,s=void 0===o?0:o,l=t.departure_time,u=void 0===l?"XX:XX":l,m=t.stops,p=void 0===m?0:m,f=t.arrival_time,d=void 0===f?"XX:XX":f,y=t.origin,v=void 0===y?"origin":y,h=t.origin_name,b=void 0===h?"origin_name":h,g=t.destination,E=void 0===g?"destination":g,j=t.destination_name,k=void 0===j?"destination_name":j,O=t.departure_date,C=void 0===O?"departure_date":O,N=t.arrival_date,_=void 0===N?"arrival_date":N;return r.a.createElement("div",{className:"ticket"},r.a.createElement("div",{className:"ticket-main"},r.a.createElement("img",{src:A.img(i,"img"),alt:A.img(i,"alt"),width:120,height:35}),r.a.createElement("a",{href:"/"},r.a.createElement("span",null,"\u041a\u0443\u043f\u0438\u0442\u044c"),"\u0437\u0430 ",A.formatPrice((s*a).toFixed()),n)),r.a.createElement("div",{className:"ticket-details"},r.a.createElement("div",{className:"ticket-time df jcsb"},r.a.createElement("div",{className:"tal"},u),p>=1&&r.a.createElement("div",{className:"ticket-stops"},A.formatStops(p)),r.a.createElement("div",{className:"tar"},d)),r.a.createElement("div",{className:"ticket-city df jcsb"},r.a.createElement("div",{className:"tal"},v,", ",b),r.a.createElement("div",{className:"tar"},E,", ",k)),r.a.createElement("div",{className:"ticket-date df jcsb"},r.a.createElement("div",{className:"tal"},A.formatDate(C,"month"),", ",A.formatDate(C,"day")),r.a.createElement("div",{className:"tar"},A.formatDate(_,"month"),", ",A.formatDate(_,"day")))))}}]),t}(a.Component)),B=function(e){function t(){return Object(g.a)(this,t),Object(j.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.setTickets()}},{key:"setTickets",value:function(){var e=this;window.fetch("https://raw.githubusercontent.com/KosyanMedia/test-tasks/master/aviasales/tickets.json").then(function(e){return e.json()}).then(function(t){var n=e.props,a=n.setTicketsAction,r=n.setFilterAvailableAction,c=t.tickets.slice(),i={};c=c.sort(function(e,t){return e.stops in i?e.price<i[e.stops]&&(i[e.stops]=e.price):i[e.stops]=e.price,t.stops in i?t.price<i[t.stops]&&(i[t.stops]=t.price):i[t.stops]=t.price,e.price-t.price}),r(i),a(c)}).catch(function(e){console.error(e)})}},{key:"render",value:function(){var e=this.props,t=e.page,n=e.filters,a=e.currency,c=t.tickets,i=n.active,o=a.symbol,s=a.rate,l=c.slice();"all"in i||(l=l.filter(function(e){return e.stops in i}));var u=l.map(function(e){return r.a.createElement(F,{data:e,symbol:o,rate:s,key:e.arrival_date+"_"+e.arrival_time})});return r.a.createElement("div",{className:"tickets-container"},u)}}]),t}(a.Component),D=Object(o.b)(function(e){return{currency:e.currency,filters:e.filters,page:e.page}},function(e){return{setTicketsAction:function(t){return e(function(e){return{type:d,payload:e}}(t))},setFilterAvailableAction:function(t){return e(function(e){return{type:y,payload:e}}(t))}}})(B),U=(n(47),n(21));Object(U.polyfill)();var X=function(e){function t(){return Object(g.a)(this,t),Object(j.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"main"},r.a.createElement("img",{className:"logo",src:"/logo.svg",alt:"logo",width:60}),r.a.createElement(T,null),r.a.createElement(D,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(o.a,{store:b},r.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.5255dad7.chunk.js.map